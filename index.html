<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±èªå¡«ç©ºéŠæˆ²</title>
    <style>
        /* --- åŸºç¤èˆ‡æ•´é«”æ¨£å¼ --- */
        :root {
            /* æ·ºè‰²æ¨¡å¼è®Šæ•¸ */
            --bg-color: #f0f4f8;
            --container-bg: white;
            --text-color: #333;
            --primary-color: #3498db;
            --secondary-color: #95a5a6;
            --audio-color: #e74c3c;
            --correct-color: #2ecc71;
            --wrong-color: #e74c3c;
            --border-color: #ccc;
            --focus-border-color: #3498db;
        }

        /* --- é»‘æš—æ¨¡å¼è¨­å®š --- */
        .dark-mode {
            --bg-color: #1e1e1e;
            --container-bg: #2d2d2d;
            --text-color: #f0f0f0;
            --primary-color: #5dade2;
            --secondary-color: #7f8c8d;
            --audio-color: #f75d52;
            --correct-color: #58d68d;
            --wrong-color: #ec7063;
            --border-color: #555;
            --focus-border-color: #5dade2;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            display: flex;
            justify-content: center;
            /* èª¿æ•´ 1: æ¢å¾©å‚ç›´ç½®ä¸­ï¼Œé¿å…è²¼è‘—é ‚éƒ¨ */
            align-items: center; 
            min-height: 100vh;
            margin: 0;
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            background: var(--container-bg);
            /* ç¶­æŒåŸæœ‰çš„ padding è¨­ç½® */
            padding: 4rem 2rem 4rem 2rem; 
            min-height: 620px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            max-width: 1500px; /* ç•«é¢å¯¬åº¦ç¶­æŒ */
            width: 90%;
            text-align: center;
            transition: background 0.3s;
        }

        h1 {
            color: var(--primary-color);
            /* ç¶­æŒç›¸å°å®šä½ */
            position: relative; 
            top: -2rem;
            margin-bottom: 1rem;
        }
        
        .question-number {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--secondary-color);
            margin-bottom: 2rem;
        }

        .chinese-hint {
            font-size: 1.2rem;
            color: var(--text-color);
            opacity: 0.85;
            margin-bottom: 1.5rem;
            font-weight: bold;
            min-height: 1.5em;
        }

        .controls {
            margin-top: 1.5rem;
            margin-bottom: 2rem;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.1s, background-color 0.2s;
            margin: 5px;
        }

        button:hover {
            background-color: #2980b9;
        }

        button:active {
            transform: scale(0.95);
        }

        button.secondary {
            background-color: var(--secondary-color);
        }
        
        button.show-answer {
            background-color: #e67e22; /* æ©˜è‰²ç³» */
        }
        
        button.show-answer:hover {
            background-color: #d35400;
        }
        
        .audio-btn {
            background-color: var(--audio-color);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 1.5rem;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* å¡«ç©ºé¡Œæ¨£å¼ */
        .sentence-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px 10px; /* å¢åŠ è¡Œè· */
            margin-bottom: 1.5rem;
            min-height: 50px;
        }

        .word-wrapper {
            display: flex;
            align-items: center; /* è®“è¼¸å…¥æ¡†å’Œæ¨™é»ç¬¦è™Ÿå°é½Š */
            position: relative;
        }

        input.word-input {
            border: none;
            border-bottom: 3px solid var(--border-color);
            background: transparent;
            font-size: 1.4rem;
            color: var(--text-color);
            text-align: center;
            padding: 5px 0;
            outline: none;
            width: 80px; /* é è¨­å¯¬åº¦ */
            transition: border-color 0.3s, color 0.3s;
        }

        input.word-input:focus {
            border-bottom-color: var(--focus-border-color);
        }

        input.word-input.correct {
            border-bottom-color: var(--correct-color);
            color: var(--correct-color);
        }

        input.word-input.wrong {
            border-bottom-color: var(--wrong-color);
            color: var(--wrong-color);
        }
        
        .static-punctuation {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-color);
            margin-left: -5px; /* è®“æ¨™é»ç¬¦è™Ÿé è¿‘å–®å­— */
            padding-bottom: 3px;
            opacity: 0.8;
        }

        .feedback {
            font-size: 1.1rem;
            height: 1.5em;
            margin-top: 1rem;
            font-weight: bold;
        }
        
        .success { color: var(--correct-color); }
        .error { color: var(--wrong-color); }

        /* é¸é¡Œåˆ—è¡¨æ¨£å¼ */
        .settings-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .theme-toggle {
            padding: 5px 10px;
            border-radius: 8px;
            background-color: var(--secondary-color);
            font-size: 0.9rem;
            margin: 0;
            width: auto;
        }
        
        #question-selector {
            padding: 8px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: var(--container-bg);
            color: var(--text-color);
            cursor: pointer;
            font-size: 0.9rem;
        }

    </style>
</head>
<body>

    <div class="container">
        
        <div class="settings-bar">
            <select id="question-selector" onchange="loadSelectedQuestion()"></select>
            <button class="theme-toggle secondary" onclick="toggleDarkMode()">ğŸŒ™ é»‘æš—æ¨¡å¼</button>
        </div>
        
        <h1>Jeançš„è‹±æ–‡æŒ‘æˆ°</h1>
        
        <p class="question-number" id="questionNumber">è¼‰å…¥ä¸­...</p>
        <p class="chinese-hint" id="chineseText"></p>

        <button class="audio-btn" onclick="playAudio()" title="æ’­æ”¾è²éŸ³">ğŸ”Š</button>

        <div class="sentence-container" id="sentenceArea">
            </div>

        <div class="controls">
            <button onclick="checkAnswer()">âœ… æª¢æŸ¥ç­”æ¡ˆ (Check)</button>
            <button class="show-answer" onclick="showAnswer()">ğŸ’¡ çœ‹è§£ç­”</button>
            <button class="secondary" onclick="nextQuestion()">â¡ï¸ ä¸‹ä¸€é¡Œ (Next)</button>
        </div>

        <div class="feedback" id="feedbackMsg"></div>
    </div>

    <script>
        // é¡Œåº«è³‡æ–™
        const questions = [
            { en: "As soon as possible", zh: "è¶Šå¿«è¶Šå¥½" },
            { en: "Under the weather", zh: "èº«é«”ä¸èˆ’æœ" },
            { en: "The train is likely to be late.", zh: "ç«è»Šå¯èƒ½æœƒæ™šé»åˆ°ã€‚" },
            { en: "May I try it on?", zh: "æˆ‘å¯ä»¥è©¦ç©¿é€™å€‹å—ï¼Ÿ" },
            { en: "I can't adjust to living on my own.", zh: "æˆ‘ä¸ç¿’æ…£ç¨è‡ªç”Ÿæ´»ã€‚" },
            { en: "We have received your application.", zh: "æˆ‘å€‘æ”¶åˆ°ä½ çš„ç”³è«‹äº†ã€‚" },
            { en: "Break a leg", zh: "ç¥ä½ å¥½é‹ (é€šå¸¸ç”¨æ–¼è¡¨æ¼”å‰)" },
            { en: "Better late than never", zh: "é²åšç¸½æ¯”ä¸åšå¥½" },
            { en: "Cut to the chase", zh: "ç›´æ¥è¬›é‡é»" },
            { en: "May we have a table by the window please?", zh: "è«‹çµ¦æˆ‘å€‘ä¸€å€‹é çª—çš„æ¡Œå­å¥½å—ï¹–" },
            { en: "You are really talented.", zh: "ä½ å¾ˆæœ‰æ‰è¯ï¼" },
            { en: "I'm so impressed with your speech.", zh: "ä½ çš„æ¼”è¬›å¸¶çµ¦æˆ‘æ·±åˆ»å°è±¡" },
            { en: "We're so proud of you.", zh: "æˆ‘å€‘ä»¥ä½ ç‚ºæ¦®ã€‚" },
            { en: "Iâ€™d like to make a reservation, please.", zh: "æˆ‘æƒ³é ç´„ã€‚" },
            { en: "Do you have any plans for this weekend?", zh: "å‘¨æœ«æœ‰ç”šéº¼è¨ˆç•«å—" },
            { en: "I passed the interview.", zh: "æˆ‘é€šéäº†é¢è©¦ã€‚" },
            { en: "This problem is difficult to solve.", zh: "é€™å€‹å•é¡Œå¾ˆé›£è§£æ±ºã€‚" },
            { en: "I am completely exhausted.", zh: "æˆ‘å·²ç¶“ç­‹ç–²åŠ›ç›¡äº†ã€‚" },
            { en: "Look at the bright side.", zh: "	å¾€å¥½çš„æ–¹é¢æƒ³ã€‚" },
            { en: "Let me know if you need anything.", zh: "å¦‚æœä½ éœ€è¦ä»€éº¼å‘Šè¨´æˆ‘ã€‚" },
            { en: "My credit card has been used fraudulently.", zh: "æˆ‘çš„ä¿¡ç”¨å¡è¢«ç›œåˆ·äº†ã€‚" },
            { en: "I found him arrogant and rude.", zh: "æˆ‘è¦ºå¾—ä»–é€™å€‹äººå¾ˆç‹‚å¦„ç„¡ç¦®ã€‚" },
            { en: "I must apologize to you for breaking the vase.", zh: "	æˆ‘å¿…é ˆç‚ºæ‰“ç¢èŠ±ç“¶å‘ä½ é“æ­‰ã€‚" },
            { en: "Did you make a formal agreement with him?", zh: "ä½ å’Œä»–é”æˆæ­£å¼å”å®šäº†å—?" },
            { en: "I encountered some unexpected problems.", zh: "æˆ‘é‡åˆ°äº†ä¸€äº›æ„æƒ³ä¸åˆ°çš„å•é¡Œã€‚" },
            { en: "	What lessons will you take this semester?", zh: "é€™å­¸æœŸä½ è¦ä¸Šä»€éº¼èª²?" },
            { en: "This is our latest investment report.", zh: "é€™æ˜¯æˆ‘å€‘æœ€æ–°çš„æŠ•è³‡å ±å‘Šã€‚" },
            { en: "Is there a supermarket nearby?", zh: "é€™é™„è¿‘æœ‰è¶…å¸‚å—ï¼Ÿ" },
            { en: "The weather forecast says it will rain tomorrow.", zh: "å¤©æ°£é å ±èªªæ˜å¤©æœƒä¸‹é›¨ã€‚" },
            { en: "I'm looking for a cheaper option.", zh: "æˆ‘åœ¨æ‰¾æ›´ä¾¿å®œçš„é¸æ“‡ã€‚" },
            { en: "Climate change has become a global concern.", zh: "æ°£å€™è®Šé·å·²æˆç‚ºå…¨çƒé—œæ³¨çš„è­°é¡Œã€‚" },
            { en: "Education is essential for social development.", zh: "æ•™è‚²å°ç¤¾æœƒç™¼å±•è‡³é—œé‡è¦ã€‚" },
            { en: "Technology is rapidly changing people's lives.", zh: "ç§‘æŠ€æ­£åœ¨å¿«é€Ÿæ”¹è®Šäººå€‘çš„ç”Ÿæ´»ã€‚" },
            { en: "Young people are facing increasing pressure.", zh: "å¹´è¼•äººé¢è‡¨è¶Šä¾†è¶Šå¤šçš„å£“åŠ›ã€‚" },
            { en: "Opponents have raised different opinions.", zh: "åå°è€…å‰‡æå‡ºäº†ä¸åŒçš„æ„è¦‹ã€‚" },
            { en: "Globalization has made countries more interdependent.", zh: "å…¨çƒåŒ–ä½¿åœ‹å®¶ä¹‹é–“æ›´åŠ äº’ç›¸ä¾è³´ã€‚" },
            { en: "Instead of complaining, try to find a solution.", zh: "èˆ‡å…¶æŠ±æ€¨ï¼Œä¸å¦‚å°‹æ‰¾è§£æ±ºæ–¹æ³•ã€‚" },
            { en: "There is no guarantee of the outcome.", zh: "ç„¡æ³•ä¿è­‰çµæœæœƒå¦‚ä½•ã€‚" },
            { en: "Do you know the Wi-Fi password here?", zh: "ä½ çŸ¥é“é€™è£¡çš„ Wi-Fi å¯†ç¢¼å—ï¼Ÿ" },
            { en: "I need to confirm our reservation.", zh: "æˆ‘éœ€è¦ç¢ºèªæˆ‘å€‘çš„é è¨‚ã€‚" },
            { en: "We have a presentation tomorrow.", zh: "æˆ‘å€‘æ˜å¤©è¦ç°¡å ±ã€‚" },
            { en: "Please submit the report before the deadline.", zh: "è«‹åœ¨æœŸé™å‰æäº¤å ±å‘Šã€‚" },
            { en: "Weâ€™ve received a response from the client.", zh: "æˆ‘å€‘æ”¶åˆ°å®¢æˆ¶çš„å›è¦†äº†ã€‚" },
            { en: "Reading improves critical thinking skills.", zh: "é–±è®€èƒ½æå‡æ‰¹åˆ¤æ€§æ€è€ƒèƒ½åŠ›ã€‚" },
            { en: "The internet makes information more accessible.", zh: "ç¶²è·¯è®“äººå€‘æ›´å®¹æ˜“å–å¾—è³‡è¨Šã€‚" },
            { en: "I believe this is a reasonable suggestion.", zh: "æˆ‘èªç‚ºé€™æ˜¯ä¸€å€‹åˆç†çš„å»ºè­°ã€‚" },
            { en: "Social media has a huge impact on society.", zh: "ç¤¾äº¤åª’é«”å°ç¤¾æœƒæœ‰å·¨å¤§å½±éŸ¿ã€‚" },
            { en: "Health is more important than anything else.", zh: "å¥åº·æ¯”ä»»ä½•äº‹æƒ…éƒ½é‡è¦ã€‚" },
            { en: "Traveling can broadens oneâ€™s horizon.", zh: "æ—…éŠèƒ½æ‹“å±•ä¸€å€‹äººçš„è¦–é‡ã€‚" },
            { en: "Building good relationships is very important.", zh: "å»ºç«‹è‰¯å¥½çš„äººéš›é—œä¿‚éå¸¸é‡è¦ã€‚" },
            { en: "Iâ€™d like to apply a new bank account.", zh: "æˆ‘æƒ³ç”³è«‹ä¸€å€‹æ–°çš„éŠ€è¡Œå¸³æˆ¶ã€‚" },     
            { en: "We need to conduct a financial analysis.", zh: "æˆ‘å€‘éœ€è¦åšä¸€ä»½è²¡å‹™åˆ†æã€‚" },
            { en: "She has a really good sense of humor", zh: "å¥¹çœŸçš„å¾ˆæœ‰å¹½é»˜æ„Ÿã€‚" },
            { en: "ï¬	He's very mature for his age.", zh: "ä»¥ä»–çš„å¹´ç´€ä¾†èªªï¼Œä»–å·²éå¸¸æˆç†Ÿã€‚" },
            { en: "Iâ€™m not sure whatâ€™s going on, but something definitely feels off.", zh: "æˆ‘ä¸ç¢ºå®šç™¼ç”Ÿäº†ä»€éº¼ï¼Œä½†æ„Ÿè¦ºè‚¯å®šå“ªè£¡ä¸å¤ªå°å‹ã€‚" },
            { en: "Can we talk about this later? I really need some time to think.", zh: "æˆ‘å€‘å¯ä»¥ç­‰ä¸€ä¸‹å†è«‡å—ï¼Ÿæˆ‘çœŸçš„éœ€è¦ä¸€äº›æ™‚é–“æ€è€ƒã€‚" },
            { en: "Iâ€™ve been meaning to tell you, but I just didnâ€™t know how to start.", zh: "æˆ‘ä¸€ç›´æƒ³è·Ÿä½ èªªï¼Œä½†æˆ‘ä¸çŸ¥é“è¦æ€éº¼é–‹å£ã€‚" },
            { en: "Iâ€™m doing the best I can, but it feels like nothing is enough lately.", zh: "æˆ‘å·²ç¶“ç›¡åŠ›äº†ï¼Œä½†æœ€è¿‘æ„Ÿè¦ºæ€éº¼åšéƒ½ä¸å¤ ã€‚" },
            { en: "I really appreciate for your help today.", zh: "æˆ‘éå¸¸æ„Ÿè¬ä½ ä»Šå¤©çš„å¹«å¿™ã€‚" },
            { en: "Tell me the truth, even if itâ€™s something I might not want to hear.", zh: "å‘Šè¨´æˆ‘çœŸç›¸ï¼Œå³ä½¿é‚£å¯èƒ½ä¸æ˜¯æˆ‘æƒ³è½çš„ã€‚" },
            { en: "You have no idea how much that meant to me, seriously.", zh: "ä½ çœŸçš„ä¸çŸ¥é“é‚£å°æˆ‘æœ‰å¤šé‡è¦ã€‚" },
            { en: "Iâ€™m trying to stay positive, but itâ€™s been really challenging lately.", zh: "æˆ‘åŠªåŠ›ä¿æŒæ­£é¢æ…‹åº¦ï¼Œä½†æœ€è¿‘çœŸçš„å¾ˆä¸å®¹æ˜“ã€‚" },
            { en: "Could you please slow down? Iâ€™m having trouble keeping up.", zh: "ä½ å¯ä»¥è¬›æ…¢ä¸€é»å—ï¼Ÿæˆ‘æœ‰é»è·Ÿä¸ä¸Šã€‚" },
            { en: "Let me handle this; youâ€™ve already done more than enough.", zh: "é€™ä»¶äº‹äº¤çµ¦æˆ‘è™•ç†å§ï¼Œä½ å·²ç¶“åšå¾—å¤ å¤šäº†ã€‚" },
            { en: "I know youâ€™re trying to help, but I need to figure this out on my own.", zh: "æˆ‘çŸ¥é“ä½ æƒ³å¹«å¿™ï¼Œä½†é€™ä»¶äº‹æˆ‘éœ€è¦è‡ªå·±ææ¸…æ¥šã€‚" },
            { en: "Iâ€™m really not in the mood to argue, so can we drop this for now?", zh: "æˆ‘ç¾åœ¨çœŸçš„ä¸æƒ³åµæ¶ï¼Œæˆ‘å€‘èƒ½ä¸èƒ½å…ˆåˆ¥è«‡é€™å€‹ï¼Ÿ" },
            { en: "If youâ€™re not comfortable with this, we can stop right here.", zh: "å¦‚æœä½ è¦ºå¾—ä¸èˆ’æœï¼Œæˆ‘å€‘å¯ä»¥å°±åœåœ¨é€™è£¡ã€‚" },
            { en: "Iâ€™m trying my best to understand your point of view.", zh: "æˆ‘æ­£åœ¨åŠªåŠ›ç†è§£ä½ çš„è§€é»ã€‚" },
            { en: "Thereâ€™s something I need to tell you, and itâ€™s kind of important.", zh: "æˆ‘æœ‰ä»¶äº‹è¦è·Ÿä½ èªªï¼Œè€Œä¸”é‚„æŒºé‡è¦çš„ã€‚" },
            { en: "I thought you said everything was under control.", zh: "æˆ‘è¨˜å¾—ä½ èªªä¸€åˆ‡éƒ½åœ¨æŒæ§ä¹‹ä¸­ã€‚" },
            { en: "Iâ€™m not trying to pressure you, just asking how you feel.", zh: "æˆ‘ä¸æ˜¯æƒ³çµ¦ä½ å£“åŠ›ï¼Œåªæ˜¯æƒ³å•å•ä½ çš„æ„Ÿå—ã€‚" },
            { en: "Youâ€™re overthinking again. Just take it one step at a time.", zh: "ä½ åˆæƒ³å¤ªå¤šäº†ï¼Œå°±ä¸€æ­¥ä¸€æ­¥ä¾†å§ã€‚" },
            { en: "I didnâ€™t expect you to show up, but Iâ€™m glad you did.", zh: "æˆ‘æ²’æƒ³åˆ°ä½ æœƒå‡ºç¾ï¼Œä½†æˆ‘å¾ˆé«˜èˆˆä½ ä¾†äº†ã€‚" },
            { en: "Do you want to talk about it, or should I just give you some space?", zh: "ä½ æƒ³èŠèŠï¼Œé‚„æ˜¯æˆ‘çµ¦ä½ ä¸€äº›ç©ºé–“ï¼Ÿ" },
            { en: "I really hope this works out, because Iâ€™ve put a lot into it.", zh: "æˆ‘çœŸçš„å¸Œæœ›é€™ä»¶äº‹èƒ½æˆåŠŸï¼Œå› ç‚ºæˆ‘æŠ•å…¥äº†å¾ˆå¤šã€‚" },
            { en: "Iâ€™m glad youâ€™re here. I really needed someone to talk.", zh: "æˆ‘å¾ˆé«˜èˆˆä½ åœ¨é€™è£¡ï¼Œæˆ‘çœŸçš„éœ€è¦æœ‰äººèªªèªªè©±ã€‚" },
            { en: "If this is too overwhelming, we can take a break anytime.", zh: "å¦‚æœäº‹æƒ…è®“ä½ è¦ºå¾—è² æ“”å¤ªé‡ï¼Œæˆ‘å€‘éš¨æ™‚å¯ä»¥ä¼‘æ¯ã€‚" },
            { en: "Iâ€™ve been thinking about what you said, and you might be right.", zh: "æˆ‘ä¸€ç›´åœ¨æƒ³ä½ èªªçš„è©±ï¼Œä¹Ÿè¨±ä½ æ˜¯å°çš„ã€‚" },
            { en: "I didnâ€™t expect you to remember that, but it means a lot to me.", zh: "æˆ‘æ²’æƒ³åˆ°ä½ é‚„è¨˜å¾—é‚£ä»¶äº‹ï¼Œé€™å°æˆ‘å¾ˆé‡è¦ã€‚" },
            { en: "Can you give me a second? I just need to catch my breath.", zh: "ä½ èƒ½çµ¦æˆ‘ä¸€é»æ™‚é–“å—ï¼Ÿæˆ‘éœ€è¦å–˜å£æ°£ã€‚" },
        ];

        // ğŸ“ è²éŸ³è®Šæ›´é‚è¼¯ 
        let englishVoices = []; // å„²å­˜å¯ç”¨çš„è‹±æ–‡ç™¼éŸ³åˆ—è¡¨

        // å–å¾—ä¸¦ç¯©é¸è‹±æ–‡ç™¼éŸ³ (é€™éœ€è¦ä¸€é»æ™‚é–“ï¼Œæ‰€ä»¥è¦ç”¨äº‹ä»¶ç›£è½)
        function loadVoices() {
            const voices = window.speechSynthesis.getVoices();
            // ç¯©é¸å‡ºæ‰€æœ‰ä»¥ 'en' é–‹é ­çš„ç™¼éŸ³ï¼Œä¾‹å¦‚ 'en-US', 'en-GB'
            englishVoices = voices.filter(voice => voice.lang.startsWith('en'));

            if (englishVoices.length === 0) {
                console.warn("æœªæ‰¾åˆ°è‹±æ–‡ç™¼éŸ³ï¼Œå°‡ä½¿ç”¨ç€è¦½å™¨é è¨­èªéŸ³ã€‚");
            } else {
                console.log(`æ‰¾åˆ° ${englishVoices.length} å€‹è‹±æ–‡ç™¼éŸ³è€…ã€‚`);
            }
        }

        // ç¢ºä¿åœ¨æ‰€æœ‰ç™¼éŸ³è¼‰å…¥å®Œæˆå¾Œï¼ŒåŸ·è¡Œ loadVoices
        if ('speechSynthesis' in window) {
            if (window.speechSynthesis.onvoiceschanged !== undefined) {
                window.speechSynthesis.onvoiceschanged = loadVoices;
            }
            // å¦‚æœäº‹ä»¶æ²’æœ‰è§¸ç™¼ï¼Œç«‹åˆ»å˜—è©¦è¼‰å…¥ä¸€æ¬¡
            loadVoices(); 
        }
        // ğŸ“ è²éŸ³è®Šæ›´é‚è¼¯ (çµæŸ)

        let currentQuestionIndex = 0; // ç•¶å‰é¡Œç›®ç´¢å¼• (0 é–‹å§‹)
        
        // åˆå§‹åŒ–éŠæˆ² (å·²ä¿®æ”¹ï¼Œé è¨­ç‚ºé»‘æš—æ¨¡å¼)
        function initGame() {
            populateSelector(); // ç”¢ç”Ÿé¸é¡Œé¸å–®
            
            // ç¢ºä¿æ¯æ¬¡éƒ½å¾ç¬¬ 0 é¡Œé–‹å§‹ (ç¬¦åˆä½¿ç”¨è€…å‰ä¸€å€‹è¦æ±‚)
            currentQuestionIndex = 0; 
            
            // --- é è¨­é»‘æš—æ¨¡å¼é‚è¼¯ä¿®æ”¹é–‹å§‹ ---
            const savedMode = localStorage.getItem('darkMode');
            let shouldBeDarkMode;

            // å¦‚æœæ²’æœ‰å„²å­˜è¨­å®š (savedMode === null)ï¼Œé è¨­ç‚º true (é»‘æš—æ¨¡å¼)
            if (savedMode === null) {
                shouldBeDarkMode = true;
            } else {
                // å¦‚æœæœ‰å„²å­˜ï¼Œå‰‡å°Šé‡å„²å­˜çš„å€¼
                shouldBeDarkMode = (savedMode === 'true');
            }
            
            // æ‡‰ç”¨æ¨¡å¼
            const themeToggleButton = document.querySelector('.theme-toggle');
            if (shouldBeDarkMode) {
                document.body.classList.add('dark-mode');
                themeToggleButton.innerText = 'â˜€ï¸ æ·ºè‰²æ¨¡å¼';
            } else {
                document.body.classList.remove('dark-mode');
                themeToggleButton.innerText = 'ğŸŒ™ é»‘æš—æ¨¡å¼';
            }
            // --- é è¨­é»‘æš—æ¨¡å¼é‚è¼¯ä¿®æ”¹çµæŸ ---
            
            loadQuestion(currentQuestionIndex); // è¼‰å…¥ç¬¬ä¸€é“é¡Œ
            document.getElementById('question-selector').value = currentQuestionIndex;
            
            // ç›£è½ Enter éµ
            document.addEventListener('keypress', handleKeyPress);
        }

        // ç”¢ç”Ÿé¸é¡Œé¸å–®
        function populateSelector() {
            const selector = document.getElementById('question-selector');
            questions.forEach((q, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.text = `ç¬¬ ${index + 1} é¡Œ`;
                selector.appendChild(option);
            });
        }
        
        // å¾é¸å–®è¼‰å…¥é¡Œç›®
        function loadSelectedQuestion() {
            const selector = document.getElementById('question-selector');
            const index = parseInt(selector.value);
            loadQuestion(index);
        }

        // æ ¸å¿ƒï¼šè¼‰å…¥ç‰¹å®šé¡Œè™Ÿçš„é¡Œç›® (ä¸å†å„²å­˜é¡Œè™Ÿ)
        function loadQuestion(index) {
            currentQuestionIndex = index;
            // ç”±æ–¼æ¯æ¬¡é–‹å•Ÿéƒ½å¾ 0 é–‹å§‹ï¼Œé€™è£¡ä¸å†å„²å­˜é¡Œè™Ÿ
            
            const currentQuestion = questions[currentQuestionIndex];

            // æ›´æ–°é¡Œè™Ÿå’Œä¸­æ–‡æç¤º
            document.getElementById('questionNumber').innerText = `ç¬¬ ${currentQuestionIndex + 1} é¡Œ / å…± ${questions.length} é¡Œ`;
            document.getElementById('chineseText').innerText = currentQuestion.zh;
            
            // æ¸…ç©ºå›é¥‹è¨Šæ¯
            document.getElementById('feedbackMsg').innerText = "";
            document.getElementById('feedbackMsg').className = "feedback";

            // ç”¢ç”Ÿè¼¸å…¥æ¡†
            createInputs(currentQuestion.en);
        }

        // éš¨æ©Ÿé¸ä¸‹ä¸€é¡Œ
        function nextQuestion() {
            // å˜—è©¦è¼‰å…¥ä¸‹ä¸€é¡Œ (å¾ªç’°)
            const nextIndex = (currentQuestionIndex + 1) % questions.length;
            loadQuestion(nextIndex);
            
            // æ›´æ–°é¸å–®ç‹€æ…‹
            document.getElementById('question-selector').value = nextIndex;
        }

        // ç”¢ç”Ÿè¼¸å…¥æ¡†é‚è¼¯ (é—œéµä¿®æ”¹)
        function createInputs(sentence) {
            const container = document.getElementById('sentenceArea');
            container.innerHTML = ''; // æ¸…ç©ºèˆŠçš„

            // ä½¿ç”¨æ­£è¦è¡¨é”å¼åˆ†å‰²å–®å­—å’Œæ¨™é»ç¬¦è™Ÿï¼Œä½†ä¿ç•™æ¨™é»ç¬¦è™Ÿ
            const parts = sentence.match(/[\w']+|[^\s\w']+/g);

            if (!parts) return;

            parts.forEach((part) => {
                // åˆ¤æ–·æ˜¯å¦ç‚ºå–®å­— (åŒ…å«æ’‡è™Ÿ)
                if (part.match(/[\w']/)) {
                    const wrapper = document.createElement('div');
                    wrapper.className = 'word-wrapper';

                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'word-input';
                    input.dataset.answer = part.toLowerCase().replace(/[^a-z0-9']/g, ''); 
                    input.placeholder = "_ ".repeat(part.length); 
                    
                    // --- é—œéµä¿®æ”¹ 1: å¢åŠ å¯¬åº¦å€ç‡ ---
                    // å°‡å€ç‡å¾ 15 å¢åŠ åˆ° 25ï¼Œç¢ºä¿é•·å–®å­—ä¸è¢«åˆ‡æ‰
                    // åŸºç¤å¯¬åº¦ 50pxï¼Œæ¯å€‹å­—å…ƒç´„ 25px
                    const width = Math.max(50, part.length * 25);
                    input.style.width = width + 'px';
                    
                    // --- é—œéµä¿®æ”¹ 2: é™åˆ¶è¼¸å…¥é•·åº¦èˆ‡è‡ªå‹•è·³è½‰ ---
                    input.maxLength = part.length; // é™åˆ¶åªèƒ½è¼¸å…¥æ­£ç¢ºé•·åº¦
                    
                    // åŠ å…¥è‡ªå‹•è·³è½‰çš„ç›£è½å™¨
                    input.addEventListener('input', function() {
                        // å¦‚æœè¼¸å…¥é•·åº¦é”åˆ°ä¸Šé™
                        if (this.value.length === parseInt(this.maxLength)) {
                            // å°‹æ‰¾ä¸‹ä¸€å€‹è¼¸å…¥æ¡†
                            const allInputs = Array.from(document.querySelectorAll('.word-input'));
                            const index = allInputs.indexOf(this);
                            if (index > -1 && index < allInputs.length - 1) {
                                allInputs[index + 1].focus(); // èšç„¦ä¸‹ä¸€å€‹
                            }
                        }
                    });

                    wrapper.appendChild(input);
                    container.appendChild(wrapper);
                } else {
                    // æ¨™é»ç¬¦è™Ÿ
                    const span = document.createElement('span');
                    span.className = 'static-punctuation';
                    span.innerText = part;
                    container.appendChild(span);
                }
            });
        }

        // æ’­æ”¾è²éŸ³ (ä½¿ç”¨ Web Speech API) - éš¨æ©Ÿç™¼éŸ³
        function playAudio() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel(); 
                const utterance = new SpeechSynthesisUtterance(questions[currentQuestionIndex].en);
                
                // --- éš¨æ©Ÿé¸å–ç™¼éŸ³è€… ---
                if (englishVoices.length > 0) {
                    // éš¨æ©Ÿé¸ä¸€å€‹ç™¼éŸ³è€…
                    const randomIndex = Math.floor(Math.random() * englishVoices.length);
                    utterance.voice = englishVoices[randomIndex];
                    // èªé€Ÿå’Œèªèª¿ä¿æŒä¸è®Šï¼Œç”±ç™¼éŸ³è€…æ±ºå®š
                } else {
                     // å¦‚æœæ²’æœ‰æ‰¾åˆ°ç‰¹å®šç™¼éŸ³ï¼Œå‰‡ä½¿ç”¨é»˜èªè¨­ç½®
                     utterance.lang = 'en-US';
                }
                // -----------------------

                utterance.rate = 0.9; 
                window.speechSynthesis.speak(utterance);
            } else {
                alert("æŠ±æ­‰ï¼Œæ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³æ’­æ”¾åŠŸèƒ½ã€‚");
            }
        }
        
        // é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆ
        function showAnswer() {
            const currentSentence = questions[currentQuestionIndex].en;
            const words = currentSentence.match(/[\w']+|[^\s\w']+/g) || [];
            const inputs = document.querySelectorAll('.word-input');
            let inputIndex = 0;

            words.forEach((word) => {
                if (word.match(/[\w']/)) {
                    if (inputs[inputIndex]) {
                        inputs[inputIndex].value = word;
                        inputs[inputIndex].classList.add('correct');
                        inputs[inputIndex].classList.remove('wrong');
                    }
                    inputIndex++;
                }
            });
            
            document.getElementById('feedbackMsg').innerText = "ğŸ’¡ æ­£ç¢ºç­”æ¡ˆå·²é¡¯ç¤ºã€‚";
            document.getElementById('feedbackMsg').className = "feedback success";
        }

        // æª¢æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const inputs = document.querySelectorAll('.word-input');
            let allCorrect = true;

            inputs.forEach((input) => {
                const correctVal = input.dataset.answer; 
                const userVal = input.value.trim().toLowerCase().replace(/[^a-z0-9']/g, '');

                if (userVal === correctVal) {
                    input.classList.add('correct');
                    input.classList.remove('wrong');
                } else {
                    input.classList.add('wrong');
                    input.classList.remove('correct');
                    allCorrect = false;
                }
            });

            const feedback = document.getElementById('feedbackMsg');
            if (allCorrect) {
                feedback.innerText = "ğŸ‰ ç­”å°äº†ï¼å¤ªæ£’äº†ï¼";
                feedback.className = "feedback success";
                
                // ç­”å°èªéŸ³ä½¿ç”¨éš¨æ©Ÿç™¼éŸ³
                const winMsg = new SpeechSynthesisUtterance("Good job!");
                if (englishVoices.length > 0) {
                    const randomIndex = Math.floor(Math.random() * englishVoices.length);
                    winMsg.voice = englishVoices[randomIndex];
                } else {
                    winMsg.lang = 'en-US';
                }
                window.speechSynthesis.speak(winMsg);
                
            } else {
                feedback.innerText = "ğŸ’ª å†è©¦ä¸€æ¬¡ï¼Œæœ‰äº›å­—æ‹¼éŒ¯å›‰ï¼";
                feedback.className = "feedback error";
            }
        }
        
        // é»‘æš—æ¨¡å¼åˆ‡æ›
        function toggleDarkMode() {
            const body = document.body;
            const button = document.querySelector('.theme-toggle');
            
            body.classList.toggle('dark-mode');
            const isDarkMode = body.classList.contains('dark-mode');
            
            if (isDarkMode) {
                button.innerText = 'â˜€ï¸ æ·ºè‰²æ¨¡å¼';
            } else {
                button.innerText = 'ğŸŒ™ é»‘æš—æ¨¡å¼';
            }
            
            // å„²å­˜è¨­å®šåˆ°ç€è¦½å™¨
            localStorage.setItem('darkMode', isDarkMode);
        }
        
        // è™•ç† Enter éµæŒ‰ä¸‹äº‹ä»¶
        function handleKeyPress(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        }

        // å•Ÿå‹•éŠæˆ²
        window.onload = initGame;

    </script>
</body>

</html>


